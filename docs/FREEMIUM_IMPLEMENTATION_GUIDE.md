# Guide d'Impl√©mentation - Refonte Freemium Aurora50

**Version:** 1.0.0  
**Date:** 29/08/2025  
**Auteur:** Architecture Team  
**Statut:** üü¢ En cours

## üìã Vue d'ensemble

### Contexte Strat√©gique
Aurora50 pivote d'un mod√®le de vente directe (47‚Ç¨/mois) vers un mod√®le **freemium** avec :
- Inscription gratuite sans friction
- Onboarding progressif
- Conversion premium sur 30 jours
- Communaut√© de 21 885 membres Facebook √† activer

### Objectifs Business
| M√©trique | Actuel | Cible | Impact |
|----------|--------|-------|--------|
| Taux d'inscription | 1-2% | 15-20% | **10x** |
| Conversion premium | 1-2% direct | 5-8% apr√®s essai | **4x** |
| CAC | 50‚Ç¨ | 10‚Ç¨ | **-80%** |
| LTV | 150‚Ç¨ | 300‚Ç¨ | **+100%** |

## üèóÔ∏è Architecture de la Refonte

### Flow Utilisateur

```mermaid
graph TD
    A[Facebook 21k] --> B[Homepage Aurora50]
    B --> C{Choix}
    C -->|Nouveau| D[/inscription]
    C -->|Existant| E[/connexion]
    
    D --> F[Magic Link Email]
    F --> G[/onboarding - 3 questions]
    G --> H[/dashboard Gratuit]
    
    H --> I[Exploration 7 jours]
    I --> J[Trigger Premium]
    J --> K{D√©cision}
    K -->|Oui| L[Stripe Checkout]
    K -->|Non| M[Reste Gratuit]
```

## üìÅ Structure des Fichiers √† Cr√©er/Modifier

```
aurora50/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx                    [MODIFIER] - Nouvelle homepage
‚îÇ   ‚îú‚îÄ‚îÄ inscription/                [CR√âER]
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx                - Page d'inscription gratuite
‚îÇ   ‚îú‚îÄ‚îÄ onboarding/                 [CR√âER]
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx                - Flow 3 questions
‚îÇ   ‚îî‚îÄ‚îÄ (lms)/
‚îÇ       ‚îî‚îÄ‚îÄ dashboard/
‚îÇ           ‚îî‚îÄ‚îÄ page.tsx            [MODIFIER] - Support freemium
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ freemium/                   [CR√âER]
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LimitBanner.tsx         - Banni√®re limites freemium
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ UpgradeModal.tsx        - Modal de conversion
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ TrialCountdown.tsx      - Compte √† rebours essai
‚îÇ   ‚îî‚îÄ‚îÄ onboarding/                 [CR√âER]
‚îÇ       ‚îî‚îÄ‚îÄ QuestionCard.tsx        - Carte de question
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useSubscription.ts      [CR√âER] - Hook gestion abonnement
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îî‚îÄ‚îÄ freemium-limits.ts      [CR√âER] - Limites et r√®gles
‚îî‚îÄ‚îÄ docs/
    ‚îú‚îÄ‚îÄ FREEMIUM_IMPLEMENTATION_GUIDE.md [CE FICHIER]
    ‚îî‚îÄ‚îÄ FREEMIUM_PROGRESS.md        [CR√âER] - Suivi implementation
```

## üéØ Phase 1 : Core (Priorit√© HAUTE)

### 1.1 Nouvelle Homepage (`/app/page.tsx`)

**Objectif:** Page d'accueil √©pur√©e sans prix, focus sur l'inscription gratuite

**Sp√©cifications:**
```typescript
interface HomepageSpec {
  hero: {
    titre: "Aurora50",
    sousTitre: "Votre Renaissance Apr√®s 50 Ans Commence Ici",
    stats: "21 885 membres actives",
    cta_principal: "Commencer Gratuitement ‚Üí /inscription",
    cta_secondaire: "J'ai d√©j√† un compte ‚Üí /connexion"
  },
  sections: {
    trust_signals: true,    // 3 m√©triques cl√©s
    testimonials: false,    // Pas en v1
    pricing: false,         // JAMAIS sur homepage
    sigrid: false          // Pas en v1
  }
}
```

**Code √† impl√©menter:**
- Design minimaliste avec gradient Aurora50
- Animation subtile sur le logo (pulse)
- Responsive mobile-first
- Pas de navigation complexe

### 1.2 Page Inscription (`/app/inscription/page.tsx`)

**Objectif:** Inscription ultra-simple en 2 champs

**Sp√©cifications:**
```typescript
interface InscriptionSpec {
  champs: {
    prenom: string,      // PAS le nom complet
    email: string        // Pour magic link
  },
  validation: {
    email_unique: true,
    prenom_min: 2,
    prenom_max: 50
  },
  after_submit: {
    action: "magic_link",
    redirect: "/inscription/confirmation",
    metadata: {
      is_new_user: true,
      source: "homepage"
    }
  }
}
```

**S√©curit√©:**
- Rate limiting : 3 tentatives par IP/heure
- Validation email c√¥t√© serveur
- Honeypot anti-bot

### 1.3 Onboarding (`/app/onboarding/page.tsx`)

**Objectif:** 3 questions pour personnaliser l'exp√©rience

**Questions:**
```javascript
const questions = [
  {
    id: "situation",
    question: "O√π en √™tes-vous aujourd'hui ?",
    options: [
      "En activit√© professionnelle",
      "En transition de carri√®re",
      "Nouvellement retrait√©e",
      "En qu√™te de sens"
    ]
  },
  {
    id: "motivation",
    question: "Qu'est-ce qui vous am√®ne ?",
    options: [
      "Besoin de changement",
      "Sentiment de solitude",
      "Envie d'apprendre",
      "Curiosit√© et d√©couverte"
    ]
  },
  {
    id: "priorite",
    question: "Votre priorit√© actuelle ?",
    options: [
      "Lib√©ration √©motionnelle",
      "Reconqu√™te du corps",
      "Nouvelle carri√®re",
      "Relations authentiques"
    ]
  }
]
```

**Logique:**
- Progression sauvegard√©e √† chaque √©tape
- Skip possible (mais d√©conseill√©)
- R√©ponses stock√©es en JSONB dans `profiles.onboarding_answers`

### 1.4 Migration Base de Donn√©es

**Script SQL √† ex√©cuter:**
```sql
-- √âtendre la table profiles
ALTER TABLE profiles 
ADD COLUMN IF NOT EXISTS onboarding_completed BOOLEAN DEFAULT false,
ADD COLUMN IF NOT EXISTS onboarding_answers JSONB,
ADD COLUMN IF NOT EXISTS subscription_type TEXT DEFAULT 'free' 
  CHECK (subscription_type IN ('free', 'premium', 'trial')),
ADD COLUMN IF NOT EXISTS subscription_started_at TIMESTAMPTZ,
ADD COLUMN IF NOT EXISTS trial_ends_at TIMESTAMPTZ,
ADD COLUMN IF NOT EXISTS conversion_triggers JSONB DEFAULT '[]'::jsonb;

-- Index pour performance
CREATE INDEX IF NOT EXISTS idx_profiles_subscription 
  ON profiles(subscription_type);
CREATE INDEX IF NOT EXISTS idx_profiles_trial_ends 
  ON profiles(trial_ends_at) 
  WHERE trial_ends_at IS NOT NULL;

-- Vue pour utilisateurs premium
CREATE OR REPLACE VIEW premium_users AS
SELECT * FROM profiles 
WHERE subscription_type IN ('premium', 'trial')
  AND (trial_ends_at IS NULL OR trial_ends_at > NOW());
```

## üéØ Phase 2 : Limites Freemium (Semaine 2)

### 2.1 D√©finition des Limites

```typescript
// lib/utils/freemium-limits.ts
export const FREEMIUM_LIMITS = {
  free: {
    chat_messages_per_day: 10,
    profile_views_per_day: 5,
    courses_accessible: ['intro', 'pilier-1-preview'],
    live_access: false,
    private_messages: false,
    sigrid_qa: false,
    downloads: false
  },
  trial: {
    duration_days: 7,
    chat_messages_per_day: 'unlimited',
    profile_views_per_day: 'unlimited',
    courses_accessible: 'all',
    live_access: true,
    private_messages: true,
    sigrid_qa: true,
    downloads: true
  },
  premium: {
    // Tout illimit√©
    all_features: true
  }
}
```

### 2.2 Hook de V√©rification

```typescript
// lib/hooks/useSubscription.ts
export function useSubscription() {
  const { user } = useAuth()
  const [limits, setLimits] = useState(null)
  const [usage, setUsage] = useState(null)
  
  const canAccess = (feature: string) => {
    // Logique de v√©rification
  }
  
  const triggerUpgrade = (reason: string) => {
    // Ouvrir modal de conversion
  }
  
  return { limits, usage, canAccess, triggerUpgrade }
}
```

## üéØ Phase 3 : Triggers de Conversion

### 3.1 Moments de Conversion

```typescript
const CONVERSION_TRIGGERS = {
  immediate: [
    'limite_chat_atteinte',      // "Vous avez atteint votre limite de 10 messages"
    'acces_cours_premium',        // "Ce cours est r√©serv√© aux membres Premium"
    'live_sigrid_locked'          // "Les lives sont exclusifs aux membres Premium"
  ],
  
  scheduled: [
    'jour_3_engagement',          // Email si actif 3 jours cons√©cutifs
    'jour_7_fin_trial',          // "Votre p√©riode d'essai se termine"
    'jour_14_reactivation'       // Si inactif depuis 7 jours
  ],
  
  contextual: [
    'profil_complete_80',        // Profil presque complet
    'premier_ami',               // Premi√®re connexion sociale
    'premier_cours_termine'      // Engagement fort
  ]
}
```

### 3.2 Modal de Conversion

```typescript
// components/freemium/UpgradeModal.tsx
interface UpgradeModalProps {
  trigger: string
  userContext: {
    days_since_signup: number
    engagement_score: number
    previous_rejections: number
  }
}

// Adapter le message selon le contexte
const getUpgradeMessage = (trigger: string, context: any) => {
  // Personnalisation du message
}
```

## üìä M√©triques √† Tracker

### Events Analytics (Mixpanel/Amplitude)

```javascript
// √âv√©nements critiques √† tracker
const EVENTS = {
  // Funnel principal
  'homepage_view': {},
  'signup_started': { source: 'homepage|programme|other' },
  'signup_completed': { time_to_complete: seconds },
  'onboarding_started': {},
  'onboarding_step': { step: 1|2|3, answer: string },
  'onboarding_completed': { answers: array },
  
  // Engagement
  'dashboard_view': { is_first_time: boolean },
  'feature_limit_hit': { feature: string, limit: number },
  'upgrade_modal_shown': { trigger: string },
  'upgrade_clicked': { trigger: string, cta: string },
  
  // Conversion
  'trial_started': { source: string },
  'payment_started': { plan: string, price: number },
  'payment_completed': { plan: string, mrr: number },
  'payment_failed': { error: string }
}
```

### KPIs √† Suivre

| M√©trique | Calcul | Objectif Semaine 1 | Objectif Mois 1 |
|----------|--------|-------------------|-----------------|
| Sign-up Rate | Inscriptions / Visiteurs | 5% | 15% |
| Onboarding Completion | Compl√©t√© / Commenc√© | 60% | 80% |
| D1 Retention | Actifs J1 / Inscrits J0 | 40% | 50% |
| D7 Retention | Actifs J7 / Inscrits J0 | 20% | 30% |
| Trial Conversion | Premium / Trials | 10% | 25% |
| Free to Paid | Premium / Total Users | 2% | 5% |

## üö® Points d'Attention

### S√©curit√©
- [ ] Rate limiting sur toutes les routes publiques
- [ ] Validation stricte des inputs
- [ ] Sanitization des donn√©es onboarding
- [ ] Protection CSRF sur les forms

### Performance
- [ ] Lazy loading des composants lourds
- [ ] Optimisation images (next/image)
- [ ] Cache des donn√©es statiques
- [ ] Pagination sur les listes

### UX
- [ ] Messages d'erreur clairs
- [ ] Feedback visuel imm√©diat
- [ ] Sauvegarde automatique onboarding
- [ ] Responsive parfait mobile

### Legal
- [ ] RGPD : consentement explicite
- [ ] CGU/CGV √† jour
- [ ] Politique de confidentialit√©
- [ ] Droit de r√©tractation

## üìÖ Planning de Livraison

### Sprint 1 (Cette semaine)
- [x] Document guide (ce fichier)
- [ ] Homepage nouvelle
- [ ] Page inscription
- [ ] Flow onboarding
- [ ] Migration DB

### Sprint 2 (Semaine prochaine)
- [ ] Limites freemium
- [ ] Hook subscription
- [ ] Banni√®res limites
- [ ] Modal upgrade

### Sprint 3 (S+2)
- [ ] Triggers email
- [ ] Analytics complet
- [ ] A/B tests
- [ ] Optimisations

## üîÑ Processus de Validation

1. **Development** ‚Üí Branche `feature/freemium-v1`
2. **Review** ‚Üí PR avec checklist
3. **Staging** ‚Üí Test avec 10 beta users
4. **Production** ‚Üí D√©ploiement progressif 10% ‚Üí 50% ‚Üí 100%

## üìö Ressources

- [Supabase Auth Docs](https://supabase.com/docs/guides/auth)
- [Next.js App Router](https://nextjs.org/docs/app)
- [Stripe Checkout](https://stripe.com/docs/payments/checkout)
- [Design System Aurora50](/docs/DESIGN_SYSTEM.md)

---

*Ce document est la r√©f√©rence unique pour l'impl√©mentation freemium.*  
*Toute modification doit √™tre approuv√©e et versionn√©e.*